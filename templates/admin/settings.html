{% extends "admin/base.html" %}

{% block title %}Admin Dashboard{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% set breadcrumb1 = "System Settings" %}
{% set breadcrumb2 = "" %}

{% block content %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />

    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="page-title">
                        <h1 class="mb-1">DTR System Settings</h1>
                        <p class="mb-0 text-muted">Configure system-wide settings for the Daily Time Record system</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="page-actions d-flex justify-content-md-end">
                        <button class="btn btn-success" id="saveSettings">
                            <i class="fas fa-save me-2"></i>Save Settings
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Form -->
        <div class="content-card">
            <div class="card-header">
                <h2 class="mb-0">System Configuration</h2>
            </div>
            <div class="card-body">
                <form id="settingsForm">
                    <!-- Unit Head Section -->
                    <div class="mb-5">
                        <h6 class="fw-bold mb-3 text-primary">
                            <i class="fas fa-user-tie me-2"></i>Unit Head Information
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="unitHeadName" class="form-label">Unit Head Name</label>
                                <input type="text" class="form-control" id="unitHeadName" placeholder="Enter unit head name" required>
                            </div>
                            <div class="col-md-6">
                                <label for="unitHeadTitle" class="form-label">Title/Position</label>
                                <input type="text" class="form-control" id="unitHeadTitle" value="Department Head" placeholder="Enter title or position" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- System Policies Section -->
                    <div class="mb-5">
                        <h6 class="fw-bold mb-3 text-primary">
                            <i class="fas fa-cogs me-2"></i>System Policies
                        </h6>
                        
                        <!-- Strict Mode -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <label class="form-label fw-medium">Enable Strict Mode</label>
                                        <div class="text-muted small">Enforce strict time tracking rules</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="enableStrictMode">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6" id="strictModeOptions" style="display: none;">
                                <label for="strictModeEndDate" class="form-label">Open Mode End Date (Optional)</label>
                                <input type="date" class="form-control" id="strictModeEndDate">
                                <small class="text-muted">Leave empty for permanent open mode</small>
                            </div>
                        </div>

                        <!-- Allow Early In -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <label class="form-label fw-medium">Allow Early In</label>
                                        <div class="text-muted small">Permit employees to clock in before start time</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="allowEarlyIn" checked disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6" id="earlyInOptions">
                                <label for="earlyInMinutes" class="form-label">Early In Allowance (minutes)</label>
                                <input type="number" class="form-control" id="earlyInMinutes" min="0" max="120" placeholder="Enter minutes">
                            </div>
                        </div>

                        <!-- Allow Early Out -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <label class="form-label fw-medium">Allow Early Out</label>
                                        <div class="text-muted small">Permit employees to clock out before end time</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="allowEarlyOut">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Allow Overtime -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <label class="form-label fw-medium">Allow Overtime</label>
                                        <div class="text-muted small">Enable overtime tracking and requests</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="allowOvertime">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Default Time Settings Section -->
                    <div class="mb-5">
                        <h6 class="fw-bold mb-3 text-primary">
                            <i class="fas fa-clock me-2"></i>Default Time Settings
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="defaultStartTime" class="form-label">Default Start Time</label>
                                <input type="time" class="form-control" id="defaultStartTime" required>
                            </div>
                            <div class="col-md-6">
                                <label for="defaultEndTime" class="form-label">Default End Time</label>
                                <input type="time" class="form-control" id="defaultEndTime" required>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Settings Section -->
                    <div class="mb-4" hidden>
                        <h6 class="fw-bold mb-3 text-primary">
                            <i class="fas fa-sliders-h me-2"></i>Additional Settings
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="gracePeriod" class="form-label">Grace Period (minutes)</label>
                                <input type="number" class="form-control" id="gracePeriod" value="15" min="0" max="60" placeholder="Enter grace period">
                                <small class="text-muted">Grace period to clock out before they are locked out to clock out which is equivalent to absent</small>
                            </div>
                            <div class="col-md-6">
                                <label for="breakDuration" class="form-label">Default Break Duration (minutes)</label>
                                <input type="number" class="form-control" id="breakDuration" value="60" min="30" max="120" placeholder="Enter break duration">
                                <small class="text-muted">Standard lunch break duration</small>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Current Settings Summary -->
        <div class="content-card mt-4">
            <div class="card-header">
                <h2 class="mb-0">Current Saved Settings</h2>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="summary-item">
                            <div class="summary-label">Unit Head</div>
                            <div class="summary-value" id="summaryUnitHead"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="summary-item">
                            <div class="summary-label">Working Hours</div>
                            <div class="summary-value" id="summaryWorkingHours">Not Set</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="summary-item">
                            <div class="summary-label">Strict Mode</div>
                            <div class="summary-value">
                                <span class="status-badge active" id="summaryStrictMode"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="summary-item">
                            <div class="summary-label">Early In Allowance</div>
                            <div class="summary-value" id="summaryEarlyIn"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="summary-item">
                            <div class="summary-label">Early Out</div>
                            <div class="summary-value">
                                <span class="status-badge active" id="summaryEarlyOut"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="summary-item">
                            <div class="summary-label">Overtime</div>
                            <div class="summary-value">
                                <span class="status-badge active" id="summaryOvertime"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6" hidden>
                        <div class="summary-item">
                            <div class="summary-label">Grace Period</div>
                            <div class="summary-value" id="summaryGracePeriod"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Alert (Hidden by default) -->
    <div class="alert alert-success alert-dismissible fade position-fixed" id="successAlert" style="top: 20px; right: 20px; z-index: 9999; display: none;">
        <i class="fas fa-check-circle me-2"></i>
        Settings saved successfully!
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
{% endblock %}
